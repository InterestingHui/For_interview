<h1>Redis</h1>
<h3>数据结构</h3>
<div>
<details style="line-height:112px"><summary>1.字符串</summary>
<li>redis中的字符串是动态字符串，叫SDS
  <li>redis中用到sds的地方：1.字符串对象：除了字符串值对象外，所有的键值对的键都是字符串对象；2.AOF持久化的输入缓冲区是用SDS实现的
  <li>SDS的内部结构：<br>(i) buf数组，是一个char类型数组，记录字符串内容。<br>(ii) free属性，int类型，记录buf数组中没有使用的字节的数量。<br>(iii) len属性记录已经使用的字节数量。
  <li>SDS和C字符串的区别：
    <br>(i) C字符串需要O（n）获取字符串长度；而SDS只需要O（1）获取字符串长度。
    <br>(ii) C字符串API操作不安全，可能会造成缓冲区溢出；而SDS API操作安全，因为在修改字符串前，会先判断会不会造成字符串缓冲区溢出，如果会的话就会先扩展字符串再修改。
    <br>(iii) SDS的内存重分配次数比C字符串少，这个得益于两个策略——<br>
      (1) 第一个是空间预分配策略，就是API对字符串进行扩展的时候，会分配额外的未使用空间，分配空间的大小取决于SDS的长度：如果SDS的长度小于1MB，那么分配的大小就是同样长度的字符串len属性的长度；如果SDS的长度大于1MB，那么分配的大小就是1MB。
      <br>(2) 第二个是惰性空间释放策略，API在对字符串进行缩短操作的时候，不会释放空闲的未使用空间，而是通过free属性记录未保存的空间长度，以便进行扩展的时候就不用再重分配空间了。（当然API也支持手动释放未保存空间的操作）
    <br>(iv) SDS buf数组保存的数据比C字符串更丰富。C字符串只能保存ASCII数据，且不能保存空字符，C字符串遇到的第一个空字符会被视作字符串的结束标志；而SDS不仅能保存ASCII数据，还能保存空字符，以及图片、音频等二进制数据，更加丰富。
    <br>(v) C字符串相较于SDS字符串的唯一好处是，C字符串能使用全部的<string.h>库中的函数，而SDS只能兼容部分<string.h>库中的函数。
</details>
        
      
</div>
